{% extends "base.html" %}
{% load crispy_forms_tags %}
{% block fluid_content %}
{% load thumbnail %}
{% load static %}
<form id='article_form' action=""  method="post" enctype="multipart/form-data">
{% csrf_token %}
<div class="container-fluid">
    <div class="row">
        <h1>{%if idk %} edytuj {% else%} dodaj nowy {% endif %} artykuł</h1>
        {{ article_form.category|as_crispy_field }}
        {% if article.pk %}
            <a href='{% url "article_details" idk=article.pk %}' type="button" class="btn btn-default ">podgląd artykułu</a>
        {% endif %}




                <button class="btn btn-default " type="submit">Zapisz zmiany</button>
                <input type="hidden" id="idk" name="variable" value="{{idk}}">

        </div>
        <div class="row">
        <div class="col-1 add_component_section">
            <button type="button" class="add_paragraph d-flex" data-toggle="modal" data-target="#TextModal"><span class="paragraph_icon"></span></button>
            <button type="button" class="add_image d-flex" data-toggle="modal" data-target="#ImageModal"><span class="image_icon"></span></button>
            <button type="button" class="add_video d-flex" data-toggle="modal" data-target="#VideoModal"><span class="video_icon"></span></button>
            <button type="button" class="add_quote d-flex" data-toggle="modal" data-target="#QuoteModal"><span class="quote_icon"></span></button>
        </div>
        <div class="col-15">

            {{ article_form.cover|as_crispy_field }}
            {% if article.cover %}
                {% thumbnail article.cover "250x250" crop="center" as img %}
                    <img class="centered articleListCover" src="{{ img.url }}" width="100" alt='okładka'>
                {% endthumbnail %}
            {% endif %}
            <div id="cover_info">
                <a href="" target="_blank">
                    <img id="preview_cover" src="" alt=""/>
                    <label id="upload_cover" for="change_cover" class="btn btn-default">Wybierz obraz z dysku</label>
                </a>
            </div>
            {{ article_form.title|as_crispy_field }}
            {{ article_form.subtitle|as_crispy_field }}
            <ul>

            </ul>
            <div class="html_templates">
                <li id="" class="ui-state-default component_li ui-sortable-handle">
                    <span class="ui-icon ui-icon-arrowthick-2-n-s"></span>
                    <span class="kind_display"></span>
                    <span class="header_name"></span>
                    <button class="btn btn-default edit_btn editComponent" data-cmd="edit" type="button" data-target=""></button>
                    <button class="btn btn-default remove_btn  deleteComponent" type="button"></button>
                    <input class="component_idk" type="hidden">
                    <input class="component_position"  value="" type="hidden">
                </li>
            </div>
            <ul id="sortable" class="articleSkeleton">
                {% if idk %}
                    {% for component in article.components.all %}
                        <li id='{{component.id}}' class="ui-state-default component_li ui-sortable-handle">
                            <span class="ui-icon ui-icon-arrowthick-2-n-s"></span>
                            {{component.get_kind_display}}
                            <span class="header_name">{{component.header}}</span>
                            <button class="btn edit_btn{% if component.kind == 'image' %} editImage {% else %} editComponent  {% endif%} "
                            data-cmd="edit" type="button" data-toggle="modal" data-target="#{{component.kind |capfirst}}Modal"></button>
                            <button class="btn remove_btn deleteComponent" type="button"></button>
                            <input class="component_idk" name="component_idk" value="{{component.id}}" type="hidden">
                            <input class="component_position" name="component_position" value="{{component.position}}" type="hidden">
                        </li>
                    {% endfor %}
                {% endif %}
            </ul>
        </div>
        </div>
    </div>
</div>
</form>
{% include "modals/textModal.html" %}
{% include "modals/quoteModal.html" %}
{% include "modals/imageModal.html" %}
{% include "modals/videoModal.html" %}


{% endblock %}
{% block js %}
<script src="{% static 'js/article_creator.js' %}"></script>

{% endblock %}
